(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[594],{1594:(e,o,s)=>{"use strict";s.r(o),s.d(o,{default:()=>h});var n=s(7557),t=s(9526),a=s(2984),c=s(6913),r=s(4333),i=s(8251);const d=(0,t.lazy)((()=>Promise.all([s.e(720),s.e(105)]).then(s.bind(s,6105))));class l extends t.Component{constructor(){super(...arguments),this.state={connected:!1,hasJoin:{user:!1,conversation:!1}},this.componentDidMount=async()=>{const{connected:e,loadNewsAsync:o,loadUserAsync:s,authenticateAsync:n,home:t,newMessage:a,newConversation:c}=this.props;await n();i.D.on("connect",(()=>{this.setState({connected:!0})})),i.D.on("disconnect",(()=>{this.setState({connected:!1,hasJoin:{user:!1,conversation:!1}})})),o(),s(),i.D.on("message:new",(e=>{console.log("new message should received"),a({...e})}))}}componentDidUpdate(e,o){const{app:s,home:n}=this.props,{connected:t,hasJoin:a}=this.state;console.log(this.state);const c=n.conversations?.data;if(o.connected!==t||c){if(!a.conversation&&t&&c){const e=c.map((e=>e.id));i.D.emit("conversation:join",{conversations:e},(e=>{e.ok?this.setState((e=>({hasJoin:{...e.hasJoin,conversation:!0}}))):console.log(e.err)}))}!a.user&&s.loggedIn&&t&&s.user?.id&&i.D.emit("user:join",{user_id:10},(e=>{e.ok?(console.log(`user join to room ${e.data}`),this.setState((e=>({hasJoin:{...e.hasJoin,user:!0}})))):console.log(e.err)}))}}componentWillUnmount(){i.D.disconnect()}render(){return void 0===this.props.app.loggedIn?(0,n.jsxs)("div",Object.assign({className:"flex items-center justify-center w-full h-screen bg-light dark:bg-dark"},{children:[(0,n.jsx)("div",{className:"w-3.5 h-3.5 mx-1 rounded-full bg-primary animate-bounce-step-1"},void 0),(0,n.jsx)("div",{className:"w-3.5 h-3.5 mx-1 rounded-full bg-primary animate-bounce-step-2"},void 0),(0,n.jsx)("div",{className:"w-3.5 h-3.5 mx-1 rounded-full bg-primary animate-bounce-step-3"},void 0)]}),void 0):(0,n.jsx)(t.Suspense,Object.assign({fallback:null},{children:(0,n.jsx)(d,{},void 0)}),void 0)}}const h=(0,a.$j)((e=>({app:e.app,home:e.home})),{connected:c.Bm,loadNewsAsync:r.oU,loadUserAsync:r.C_,authenticateAsync:c.Nz,newMessage:r.rW,newConversation:r.Ki})(l)},8251:(e,o,s)=>{"use strict";s.d(o,{D:()=>a});var n=s(5615);const t={main:`${s(2838).ho}/`},a=(0,n.io)(t.main)},4333:(e,o,s)=>{"use strict";s.d(o,{oU:()=>a,C_:()=>c,dy:()=>r,a3:()=>i,xu:()=>d,Ki:()=>l,rW:()=>h});var n=s(3730),t=s(5387);const a=()=>(e,o)=>{const s=o().home,a=s.news?.meta.next_page_url||"",c=s.news?.meta.next_page_url;s.news&&!c||t.h.post(`/news${a}`).then((o=>{var s;e((s=o.data,{type:n.Gg,payload:{news:s}}))})).catch((e=>{console.error(e)}))},c=()=>(e,o)=>{o().home.users||t.h.post("/users").then((o=>{var s;e((s={data:o.data},{type:n.vu,payload:{user:s}}))})).catch((e=>{console.error(e)}))},r=e=>({type:n.Aq,payload:{id:e}}),i=()=>(e,o)=>{const{app:s,home:a}=o(),c=s.auth?.token||"";a.conversations||t.h.post("/conversations",{},{headers:{Authorization:`Bearer ${c}`}}).then((o=>{var s;e((s={data:o.data},{type:n.Eq,payload:{conversation:s}}))})).catch((e=>{console.error(e)}))},d=e=>({type:n.tr,payload:{id:e}}),l=e=>({type:n.$t,payload:{...e}}),h=e=>({type:n.$v,payload:{...e}})}}]);